# دليل إدارة المحاضرات - Lecture Management Guide

## نظرة عامة / Overview

تم إضافة نظام شامل لإدارة المحاضرات يسمح للمشرف (Admin) بإضافة وتعديل وحذف المحاضرات مع إمكانية رفع فيديوهات لكل محاضرة.

A comprehensive lecture management system has been added that allows administrators to add, edit, and delete lectures with video upload capability for each lecture.

---

## الميزات الرئيسية / Main Features

### 1. قاعدة البيانات / Database

تم إضافة جدول `lectures` يحتوي على:
- **id**: المعرف الفريد للمحاضرة
- **title**: عنوان المحاضرة
- **description**: وصف تفصيلي للمحاضرة
- **video_path**: مسار الفيديو (اختياري)
- **section**: القسم (الفقه، التفسير، الحديث، السيرة)
- **created_at**: تاريخ الإنشاء
- **updated_at**: تاريخ آخر تحديث

### 2. العمليات المتاحة / Available Operations

#### إضافة محاضرة / Add Lecture
- اختيار القسم المناسب (الفقه، التفسير، الحديث، السيرة)
- إدخال عنوان ووصف المحاضرة
- رفع فيديو (اختياري)
- يتم حفظ المحاضرة في قاعدة البيانات

#### تعديل محاضرة / Edit Lecture
- عرض جميع المحاضرات المتاحة
- تعديل العنوان والوصف
- تغيير أو إضافة فيديو
- حفظ التغييرات

#### حذف محاضرة / Delete Lecture
- عرض جميع المحاضرات
- تأكيد الحذف قبل التنفيذ
- حذف دائم من قاعدة البيانات

---

## كيفية الاستخدام / How to Use

### للمشرف / For Administrators

1. **تسجيل الدخول كمشرف**
   - استخدم بيانات المشرف المحفوظة في قاعدة البيانات
   - (راجع ملف `ADMIN_CREDENTIALS.md` لمعرفة بيانات الدخول)

2. **الوصول إلى لوحة إدارة المحاضرات**
   - من الصفحة الرئيسية للمشرف، اضغط على زر "إدارة المحاضرات"
   - ستظهر لك لوحة تحكم شاملة تحتوي على:
     - إحصائيات عن عدد المحاضرات
     - إحصائيات لكل قسم
     - أزرار الإدارة

3. **إضافة محاضرة جديدة**
   ```
   الخطوات:
   ① اضغط على "إضافة محاضرة جديدة"
   ② اختر القسم المناسب
   ③ أدخل عنوان المحاضرة
   ④ أدخل وصف تفصيلي
   ⑤ (اختياري) اختر فيديو للمحاضرة
   ⑥ اضغط "حفظ المحاضرة"
   ```

4. **تعديل محاضرة**
   ```
   الخطوات:
   ① اضغط على "تعديل المحاضرات"
   ② اختر المحاضرة التي تريد تعديلها
   ③ عدّل البيانات المطلوبة
   ④ يمكنك تغيير أو إضافة فيديو
   ⑤ اضغط "حفظ" لحفظ التغييرات
   ```

5. **حذف محاضرة**
   ```
   الخطوات:
   ① اضغط على "حذف المحاضرات"
   ② اختر المحاضرة التي تريد حذفها
   ③ أكد عملية الحذف
   ⚠️ تحذير: لا يمكن التراجع عن الحذف!
   ```

---

## البنية التقنية / Technical Structure

### الملفات المعدّلة / Modified Files

1. **lib/database/app_database.dart**
   - إضافة جدول `lectures`
   - إضافة دوال CRUD للمحاضرات
   - تحديث إصدار قاعدة البيانات إلى 2

2. **lib/screens/add_lecture_page.dart**
   - واجهة إضافة محاضرة مع رفع فيديو
   - استخدام `file_picker` لاختيار الفيديو
   - حفظ البيانات في قاعدة البيانات

3. **lib/screens/Edit_Lecture_Page.dart**
   - عرض جميع المحاضرات
   - إمكانية تعديل أي محاضرة
   - تغيير أو إضافة فيديو

4. **lib/screens/Delete_Lecture_Page.dart**
   - عرض المحاضرات مع التفاصيل
   - حذف آمن مع تأكيد
   - عرض إحصائيات

5. **lib/screens/admin_panel_page.dart** (جديد)
   - لوحة تحكم شاملة لإدارة المحاضرات
   - إحصائيات حسب الأقسام
   - روابط سريعة لجميع العمليات

6. **lib/screens/Admin_home_page.dart**
   - إضافة زر "إدارة المحاضرات"
   - الربط مع صفحة إدارة المحاضرات

7. **pubspec.yaml**
   - إضافة حزمة `file_picker: ^8.1.6`

---

## قاعدة البيانات / Database

### جدول المحاضرات / Lectures Table

```sql
CREATE TABLE lectures(
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  title TEXT NOT NULL,
  description TEXT NOT NULL,
  video_path TEXT,
  section TEXT NOT NULL,
  created_at TEXT NOT NULL,
  updated_at TEXT NOT NULL
)
```

### العمليات المتاحة / Available Operations

```dart
// إضافة محاضرة
await DatabaseHelper().addLecture(
  title: 'عنوان المحاضرة',
  description: 'وصف المحاضرة',
  videoPath: '/path/to/video.mp4', // optional
  section: 'الفقه',
);

// تحديث محاضرة
await DatabaseHelper().updateLecture(
  id: lectureId,
  title: 'عنوان جديد',
  description: 'وصف جديد',
  videoPath: '/new/path.mp4',
  section: 'الفقه',
);

// حذف محاضرة
await DatabaseHelper().deleteLecture(lectureId);

// الحصول على جميع المحاضرات
List<Map<String, dynamic>> lectures = await DatabaseHelper().getAllLectures();

// الحصول على محاضرات قسم معين
List<Map<String, dynamic>> fiqhLectures = 
    await DatabaseHelper().getLecturesBySection('الفقه');

// البحث في المحاضرات
List<Map<String, dynamic>> results = 
    await DatabaseHelper().searchLectures('كلمة البحث');
```

---

## الأقسام المتاحة / Available Sections

1. **الفقه** (Fiqh) - لون أزرق
2. **التفسير** (Tafsir) - لون أخضر
3. **الحديث** (Hadith) - لون برتقالي
4. **السيرة** (Seerah) - لون بنفسجي

---

## ملاحظات مهمة / Important Notes

### للمطورين / For Developers

1. **إصدار قاعدة البيانات**
   - تم تحديث الإصدار من 1 إلى 2
   - يتم إنشاء جدول `lectures` تلقائياً عند الترقية
   - البيانات القديمة محفوظة

2. **رفع الفيديو**
   - يتم حفظ مسار الفيديو فقط في قاعدة البيانات
   - الفيديو يبقى في مكانه الأصلي
   - يمكن إضافة المحاضرة بدون فيديو

3. **التحديثات المستقبلية**
   - يمكن إضافة ميزة رفع الفيديو إلى خادم
   - يمكن إضافة مشغل فيديو داخل التطبيق
   - يمكن إضافة تصنيفات إضافية

### للمستخدمين / For Users

1. يجب أن تكون مشرفاً للوصول إلى صفحة إدارة المحاضرات
2. تأكد من إدخال عنوان ووصف واضحين لكل محاضرة
3. يمكنك إضافة المحاضرة بدون فيديو وإضافته لاحقاً
4. احذف المحاضرات بحذر - لا يمكن استعادتها بعد الحذف

---

## الاختبار / Testing

### خطوات الاختبار / Testing Steps

1. **تسجيل دخول المشرف**
   ```
   ✓ تسجيل دخول بحساب مشرف
   ✓ التأكد من الوصول إلى لوحة التحكم
   ```

2. **إضافة محاضرة**
   ```
   ✓ إضافة محاضرة بفيديو
   ✓ إضافة محاضرة بدون فيديو
   ✓ التأكد من حفظ البيانات
   ✓ التحقق من ظهورها في القائمة
   ```

3. **تعديل محاضرة**
   ```
   ✓ فتح صفحة التعديل
   ✓ تعديل العنوان والوصف
   ✓ إضافة/تغيير الفيديو
   ✓ حفظ التغييرات
   ✓ التحقق من التحديث
   ```

4. **حذف محاضرة**
   ```
   ✓ فتح صفحة الحذف
   ✓ اختيار محاضرة
   ✓ تأكيد الحذف
   ✓ التحقق من الحذف
   ```

---

## استكشاف الأخطاء / Troubleshooting

### مشاكل شائعة / Common Issues

1. **لا تظهر المحاضرات**
   - تأكد من إضافة محاضرات أولاً
   - اضغط على زر التحديث ⟳

2. **خطأ عند رفع الفيديو**
   - تأكد من تثبيت حزمة `file_picker`
   - تأكد من صلاحيات الوصول للملفات

3. **خطأ في قاعدة البيانات**
   - قد تحتاج إلى إلغاء تثبيت التطبيق وإعادة تثبيته
   - سيتم إنشاء قاعدة بيانات جديدة تلقائياً

---

## التطوير المستقبلي / Future Development

### ميزات مقترحة / Suggested Features

- [ ] رفع الفيديو إلى خادم سحابي
- [ ] مشغل فيديو مدمج في التطبيق
- [ ] إضافة مرفقات PDF للمحاضرات
- [ ] نظام تقييمات للمحاضرات
- [ ] إضافة تعليقات على المحاضرات
- [ ] إحصائيات متقدمة (عدد المشاهدات، etc.)
- [ ] البحث المتقدم والتصفية
- [ ] ترتيب المحاضرات (drag & drop)
- [ ] إشعارات عند إضافة محاضرة جديدة

---

## الدعم / Support

إذا واجهت أي مشاكل أو لديك استفسارات، يرجى:
1. مراجعة هذا الدليل أولاً
2. التحقق من ملفات التوثيق الأخرى
3. فحص الكود في الملفات المذكورة أعلاه

---

**تاريخ آخر تحديث:** 2025-10-11  
**الإصدار:** 1.0.0

